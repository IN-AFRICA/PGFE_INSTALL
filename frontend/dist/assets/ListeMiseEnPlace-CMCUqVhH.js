import{d as T,r as N,A as w,v as C,p as D,x as p,w as s,f as t,b as r,i as a,k as m,$ as V,y as o,c as j,F as B,G as F,o as c,t as d}from"./index-CJ_PivE-.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{_ as I,a as Y,b as _,c as u,d as M,e as i}from"./TableHeader.vue_vue_type_script_setup_true_lang-cS4zBTGx.js";import{_ as P}from"./Checkbox.vue_vue_type_script_setup_true_lang-DTckireD.js";import{_ as U}from"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import{_ as H}from"./SaisieRhLayout.vue_vue_type_script_setup_true_lang-CNwSXs2g.js";import{_ as q}from"./TabPagination.vue_vue_type_script_setup_true_lang-Dsg8W898.js";import{u as A}from"./useGetApi-EdzHoZm6.js";import"./index-BpkKmY4O.js";import"./RovingFocusGroup-BxePylpC.js";import"./DashPageHeader.vue_vue_type_script_setup_true_lang-DucYyTAx.js";import"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";const J={class:"flex sm:items-center gap-3 flex-col sm:flex-row sm:justify-between"},K={class:"relative flex-1"},Q={class:"flex flex-wrap items-center sm:justify-end gap-2.5 flex-1"},W={class:"mt-4 rounded-md overflow-hidden flex flex-1 bg-white"},X={class:"flex items-center gap-2 w-max"},pe=T({__name:"ListeMiseEnPlace",setup(Z){const $=N(1),b=N(15),{data:g,fetchData:E,loading:S}=A(w.GET_PERSONNEL_AFFECTATION),{data:v,fetchData:k}=A(w.GET_PERSONALS),{data:L,fetchData:h}=A(w.GET_SCHOOL_YEARS);C(async()=>{await Promise.all([E(),k(),h()])});const R=f=>{var n;const l=(Array.isArray(v.value)?v.value:((n=v.value)==null?void 0:n.data)||[]).find(y=>y.id===f);return l?`${l.name||l.nom||""} ${l.postnom||""} ${l.firstname||l.prenom||""}`.trim():"Inconnu"},z=f=>{const e=L.value,n=(Array.isArray(e)?e:(e==null?void 0:e.years)??[]).find(y=>y.id===f);return n&&(n.name||n.label)||"N/A"},x=D(()=>{var e;return(Array.isArray(g.value)?g.value:((e=g.value)==null?void 0:e.data)||[]).map(l=>({id:l.id,date:l.created_at?new Date(l.created_at).toLocaleDateString("fr-FR"):"N/A",annee:z(l.school_year_id),personnel:R(l.personal_id),lieu:l.lieu_affectation||"N/A",duree:l.durree_jours?`${l.durree_jours} jours`:"N/A",description:l.description||"-"}))}),O=D(()=>x.value.length);return(f,e)=>{const l=V("RouterLink");return c(),p(H,{activeBread:"Mise en place","active-tag-name":"mise-en-place-personnel",group:"saisie"},{default:s(()=>[t(U,null,{default:s(()=>[r("div",J,[r("div",K,[t(a(G),{type:"text",id:"search",name:"search",placeholder:"Rechercher une affectation...",class:"w-full max-w-sm ps-10 border border-gray-200/40 bg-white transition-all h-10 rounded-md"}),e[2]||(e[2]=r("div",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-foreground-muted/70"},[r("span",{class:"flex iconify hugeicons--search-01 text-sm"})],-1))]),r("div",Q,[t(a(m),{size:"md",class:"","as-child":""},{default:s(()=>[t(l,{to:"/rh/saisie/mise-en-place-personnel/nouvelle-affectation",class:"rounded-md max-sm:flex-1 sm:w-max flex items-center gap-2"},{default:s(()=>[...e[3]||(e[3]=[r("span",{class:"flex iconify hugeicons--plus-sign"},null,-1),r("span",{class:"hidden sm:flex"},"Nouvelle affectation",-1)])]),_:1})]),_:1})])]),r("div",W,[t(a(I),{class:"rounded-md bg-white"},{default:s(()=>[t(a(Y),null,{default:s(()=>[t(a(_),null,{default:s(()=>[t(a(u),{class:"w-[20px]"},{default:s(()=>[t(a(P),{class:"bg-white scale-70"})]),_:1}),t(a(u),null,{default:s(()=>[...e[4]||(e[4]=[o("Date création",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[5]||(e[5]=[o("Année Scolaire",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[6]||(e[6]=[o("Personnel",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[7]||(e[7]=[o("Lieu d'affectation",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[8]||(e[8]=[o("Durée",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[9]||(e[9]=[o("Description",-1)])]),_:1}),t(a(u),null,{default:s(()=>[...e[10]||(e[10]=[o(" Opérations ",-1)])]),_:1})]),_:1})]),_:1}),t(a(M),null,{default:s(()=>[a(S)?(c(),p(a(_),{key:0},{default:s(()=>[t(a(i),{colspan:"8",class:"text-center py-8"},{default:s(()=>[...e[11]||(e[11]=[o(" Chargement... ",-1)])]),_:1})]),_:1})):x.value.length===0?(c(),p(a(_),{key:1},{default:s(()=>[t(a(i),{colspan:"8",class:"text-center py-8 text-gray-500"},{default:s(()=>[...e[12]||(e[12]=[o(" Aucune affectation trouvée. ",-1)])]),_:1})]),_:1})):(c(!0),j(F,{key:2},B(x.value,n=>(c(),p(a(_),{key:n.id},{default:s(()=>[t(a(i),{class:"w-[40px]"},{default:s(()=>[t(a(P),{class:"bg-white scale-70"})]),_:1}),t(a(i),null,{default:s(()=>[o(d(n.date),1)]),_:2},1024),t(a(i),null,{default:s(()=>[o(d(n.annee),1)]),_:2},1024),t(a(i),null,{default:s(()=>[o(d(n.personnel),1)]),_:2},1024),t(a(i),null,{default:s(()=>[o(d(n.lieu),1)]),_:2},1024),t(a(i),null,{default:s(()=>[o(d(n.duree),1)]),_:2},1024),t(a(i),{class:"max-w-xs truncate",title:n.description},{default:s(()=>[o(d(n.description),1)]),_:2},1032,["title"]),t(a(i),null,{default:s(()=>[r("div",X,[t(a(m),{variant:"outline",size:"icon",class:"size-8"},{default:s(()=>[...e[13]||(e[13]=[r("span",{class:"iconify hugeicons--view"},null,-1)])]),_:1}),t(a(m),{variant:"outline",size:"icon",class:"size-8"},{default:s(()=>[...e[14]||(e[14]=[r("span",{class:"iconify hugeicons--edit-02"},null,-1)])]),_:1}),t(a(m),{variant:"destructive",size:"icon",class:"size-8"},{default:s(()=>[...e[15]||(e[15]=[r("span",{class:"iconify hugeicons--delete-02"},null,-1)])]),_:1})])]),_:1})]),_:2},1024))),128))]),_:1})]),_:1})]),t(q,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=n=>$.value=n),perPage:b.value,totalItems:O.value,"onUpdate:perPage":e[1]||(e[1]=n=>b.value=n)},null,8,["modelValue","perPage","totalItems"])]),_:1})]),_:1})}}});export{pe as default};
