import{T as g,d as R,r as B,u as N,A as I,s as f,a as O,c as o,b as s,_ as P,e as L,f as d,w,g as $,h as k,i as t,j as y,t as h,k as G,o as r,l as q}from"./index-CJ_PivE-.js";import{_ as D}from"./Card.vue_vue_type_script_setup_true_lang-D6d8RJcP.js";import{_ as b}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{o as U,s as _,u as H,a as C,t as J}from"./vee-validate-zod-Bra4yLtR.js";import{u as K}from"./usePostApi-Crg8MURP.js";import"./index-BpkKmY4O.js";const Q=()=>({getCsrfToken:async()=>Promise.resolve(),checkAuthStatus:()=>{const n=g.getCSRFToken(),l=g.getBearerToken();return{hasCSRF:!!n,hasBearer:!!l,isAuthenticated:!!l}}}),W={class:"min-h-screen flex items-center justify-center p-4 relative"},X={class:"w-full max-w-6xl flex flex-col lg:flex-row items-center gap-8 lg:gap-16 relative"},Y={class:"w-full max-w-md"},Z={class:"relative"},ee={key:0,class:"text-red-600 text-sm mt-1"},se={class:"relative"},te={key:0,class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},oe={key:1,class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},re={key:0,class:"text-red-600 text-sm mt-1"},ae={key:0},le={key:1,class:"flex items-center gap-2"},ce=R({__name:"LoginForm",setup(S){const{loading:m,error:n,response:l,postData:T,success:V}=K(),{getCsrfToken:z}=Q(),E=U({email:_({required_error:"Veuillez saisir votre email"}).min(1,"Veuillez saisir votre email").email("Format d'email invalide"),password:_({required_error:"Veuillez saisir votre mot de passe"}).min(8,"Le mot de passe doit contenir au moins 8 caractères")}),{handleSubmit:M,errors:i,resetForm:A}=H({validationSchema:J(E)}),{value:p}=C("email"),{value:c}=C("password"),F=O(),u=B(!1),j=N(),v=M(async x=>{try{if(await z(),await T(I.LOGIN,x),n.value){f({message:n.value||"Erreur lors de la connexion",type:"error"});return}else V.value&&(f({message:"Connexion réussie !",type:"success"}),j.setSession(l.value.token,l.value.user),F.push("/"),A())}catch(e){f({message:"Erreur de sécurité. Veuillez réessayer.",type:"error"}),console.error("Erreur CSRF:",e)}});return(x,e)=>(r(),o("div",W,[e[12]||(e[12]=s("div",{class:"fixed inset-0"},[s("img",{src:P,alt:"pattern background",class:"size-full object-cover"})],-1)),s("div",X,[e[11]||(e[11]=L('<div class="flex-1 space-y-6 text-center lg:text-left"><div class="flex justify-center max-w-md"><img src="'+q+'" width="500" class="h-24 w-auto"></div><div class="max-w-md"><h1 class="text-3xl lg:text-4xl font-bold text-gray-800 leading-tight"> PROGICIEL DE GESTION<br> FORMATION EMPLOI </h1></div><div class="space-y-4 max-w-md text-foreground text-sm leading-relaxed mx-auto lg:mx-0"><p> PGFER est un progiciel qui vous permet la gestion, la centralisation et la mesure de vos informations à partir de vos actions. </p><p> c&#39;est un outil complet pour les écoles, le centre de formation, mais également pour le suivi de l&#39;insertion professionnelle des apprenants, tout en mettant aussi un point sur les personnels. </p></div></div>',1)),s("div",Y,[d(t(D),{class:"bg-white rounded-lg p-6 lg:p-8"},{default:w(()=>[e[10]||(e[10]=s("div",{class:"mb-6"},[s("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"Connectez-vous"),s("p",{class:"text-gray-500 text-sm"},"saisissez les coordonnées")],-1)),s("form",{class:"space-y-5",onSubmit:e[3]||(e[3]=$((...a)=>t(v)&&t(v)(...a),["prevent"]))},[s("div",null,[e[5]||(e[5]=s("label",{for:"username",class:"block text-sm font-medium text-gray-700 mb-2"}," Nom d'utilisateur ",-1)),s("div",Z,[d(t(b),{modelValue:t(p),"onUpdate:modelValue":e[0]||(e[0]=a=>y(p)?p.value=a:null),type:"text",id:"username",name:"username",placeholder:"utilisateur",class:"w-full pr-10 border border-gray-200 transition-all"},null,8,["modelValue"]),e[4]||(e[4]=s("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2"},[s("svg",{class:"w-5 h-5 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})])],-1))]),t(i).email?(r(),o("p",ee,h(t(i).email),1)):k("",!0)]),s("div",null,[e[8]||(e[8]=s("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"}," Mot de passe ",-1)),s("div",se,[d(t(b),{modelValue:t(c),"onUpdate:modelValue":e[1]||(e[1]=a=>y(c)?c.value=a:null),type:u.value?"text":"password",id:"password",name:"password",placeholder:"••••••••",autocomplete:"password",class:"w-full pr-10 outline-none transition-all"},null,8,["modelValue","type"]),s("button",{onClick:e[2]||(e[2]=a=>u.value=!u.value),type:"button",class:"absolute right-3 top-1/2 transform -translate-y-1/2"},[u.value?(r(),o("svg",oe,[...e[7]||(e[7]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.542-7a10.05 10.05 0 012.424-4.043M9.88 9.88a3 3 0 014.24 4.24m-6.99-6.99L4 4m16 16l-4.24-4.24"},null,-1)])])):(r(),o("svg",te,[...e[6]||(e[6]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])]),t(i).password?(r(),o("p",re,h(t(i).password),1)):k("",!0)]),d(t(G),{type:"submit",class:"w-full mt-4",disabled:t(m)},{default:w(()=>[t(m)?(r(),o("span",le,[...e[9]||(e[9]=[s("span",{class:"iconify animate-spin hugeicons--loading-03 text-xl"},null,-1),s("span",null,"Connexion en cours...",-1)])])):(r(),o("span",ae,"Se connecter"))]),_:1},8,["disabled"])],32)]),_:1})])])]))}});export{ce as default};
