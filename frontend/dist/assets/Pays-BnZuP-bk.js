import{d as B,r as v,A as h,s as g,x as F,i as e,K as G,w as t,f as a,k as f,b as n,L as q,M as L,N as Y,y as d,O as K,g as W,c as r,h as ae,z as X,j as te,t as z,P as Z,o,p as D,v as ne,a2 as le,G as O,F as ie,R as oe,S as re,U as ue,V as de,W as me,X as pe,Y as fe,Z as ce}from"./index-CJ_PivE-.js";import{_ as _e}from"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import{_ as ye}from"./DashPageHeader.vue_vue_type_script_setup_true_lang-DucYyTAx.js";import{_ as ve}from"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import{_ as ge}from"./DialogTrigger.vue_vue_type_script_setup_true_lang-Bm461x8Q.js";import{_ as P}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{o as xe,s as be,u as $e,a as ke,t as Ce}from"./vee-validate-zod-Bra4yLtR.js";import{e as $}from"./eventBus-CGRXT3Tn.js";import{u as we}from"./usePostApi-Crg8MURP.js";import{_ as R}from"./IconifySpinner.vue_vue_type_script_setup_true_lang-C3Td1B5O.js";import{u as Ee}from"./useGetApi-EdzHoZm6.js";import{u as Se}from"./useDeleteApi-D2AjqV8w.js";import{u as Ae}from"./usePutApi-BrTvEW5v.js";import{_ as Te}from"./TableRowActions.vue_vue_type_script_setup_true_lang-C8PT7-8D.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";import"./index-BpkKmY4O.js";const Ue={class:"grid gap-4 py-4"},he={class:"flex flex-col space-y-1.5"},Ve={key:0,class:"text-red-500 text-xs mt-1"},Ne={key:0,class:"flex items-center gap-2"},je={key:1,class:"flex items-center gap-2"},ze=B({__name:"NewCountry",setup(H){const c=v(!1),{loading:_,error:k,response:x,postData:V,success:N}=we(),C=xe({name:be({required_error:"Veuillez saisir le nom du pays"}).min(2).max(100)}),{handleSubmit:w,resetForm:E}=$e({validationSchema:Ce(C)}),{value:y,errorMessage:S}=ke("name"),A=w(async p=>{var m;const l={...p,name:p.name.trim()};if(await V(h.CREATE_COUNTRY,l),k.value){g({message:k.value,type:"error"});return}N.value&&($.emit("countryUpdated"),g({message:((m=x.value)==null?void 0:m.message)||"Pays ajouté avec succès",type:"success"}),E(),c.value=!1)});return(p,l)=>(o(),F(e(G),{open:c.value,"onUpdate:open":l[3]||(l[3]=m=>c.value=m)},{default:t(()=>[a(e(ge),{"as-child":""},{default:t(()=>[a(e(f),{size:"md",class:"rounded-md"},{default:t(()=>[...l[4]||(l[4]=[n("span",{class:"iconify hugeicons--plus-sign"},null,-1),n("span",{class:"hidden sm:flex"}," Ajouter un pays ",-1)])]),_:1})]),_:1}),a(e(q),{class:"sm:max-w-[400px]"},{default:t(()=>[a(e(L),null,{default:t(()=>[a(e(Y),null,{default:t(()=>[...l[5]||(l[5]=[d("Ajouter un Pays",-1)])]),_:1}),a(e(K),null,{default:t(()=>[...l[6]||(l[6]=[d(" Enregistrer un pays ",-1)])]),_:1})]),_:1}),n("form",{onSubmit:l[2]||(l[2]=W((...m)=>e(A)&&e(A)(...m),["prevent"]))},[n("div",Ue,[n("div",he,[a(e(X),{for:"name",class:"text-sm font-medium"},{default:t(()=>[...l[7]||(l[7]=[d(" Nom du pays ",-1)])]),_:1}),a(e(P),{type:"text",id:"name",name:"name",modelValue:e(y),"onUpdate:modelValue":l[0]||(l[0]=m=>te(y)?y.value=m:null),placeholder:"Entrez le nom du pays",class:"w-full h-10 border border-gray-200/40 bg-white transition-all",disabled:e(_)},null,8,["modelValue","disabled"]),e(S)?(o(),r("span",Ve,z(e(S)),1)):ae("",!0)])]),a(e(Z),{class:"flex justify-end gap-2 items-center"},{default:t(()=>[a(e(f),{size:"sm",class:"h-9",variant:"outline",type:"button",onClick:l[1]||(l[1]=()=>{e(E)(),c.value=!1}),disabled:e(_)},{default:t(()=>[...l[8]||(l[8]=[n("span",{class:"iconify flex hugeicons--cancel-01 mr-1"},null,-1),d(" Annuler ",-1)])]),_:1},8,["disabled"]),a(e(f),{size:"sm",class:"h-9",type:"submit",disabled:e(_)},{default:t(()=>[e(_)?(o(),r("span",je,[a(R,{size:"lg"}),l[10]||(l[10]=n("span",null,"Enregistrement en cours...",-1))])):(o(),r("span",Ne,[...l[9]||(l[9]=[n("span",{class:"iconify hugeicons--floppy-disk mr-1"},null,-1),n("span",null,"Enregistrer",-1)])]))]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"]))}}),Pe={class:"pb-6 mx-auto w-full max-w-7xl"},Re={class:"flex items-center gap-3 justify-between"},Me={class:"relative flex-1"},Ie={class:"flex items-center gap-2"},De={class:"mt-4 flex-1 min-h-0 overflow-auto bg-white rounded-md border border-gray-100"},Oe={key:0,class:"p-4 text-sm text-gray-600"},Be={key:1,class:"p-4 text-sm text-red-600"},Fe={key:0,class:"p-4 text-sm text-gray-600"},Ge={key:1,class:"divide-y"},qe={class:"flex items-center gap-3"},Le={class:"font-medium"},Ye={key:0,class:"flex items-center gap-2"},Ke={key:1},We={class:"grid gap-4 py-4"},Xe={class:"flex flex-col space-y-1.5"},Ze={key:0,class:"flex items-center gap-2"},He={key:1,class:"flex items-center gap-2"},cs=B({__name:"Pays",setup(H){const c={items:[{label:"Accueil",href:"/",icon:"hugeicons--home-01"},{label:"Administration",href:"/admin"},{label:"Pays",isActive:!0}]},_=[{name:"pays",text:"Pays",href:"/admin/countries"},{name:"provinces",text:"Provinces",href:"/admin/provinces"},{name:"territoires",text:"Territoires",href:"/admin/territoires"},{name:"communes",text:"Communes",href:"/admin/communes"}],k=D(()=>"pays"),x=v(""),{data:V,loading:N,error:C,fetchData:w}=Ee(h.GET_COUNTRIES),{deleteItem:E,deleting:y,errorDelete:S}=Se(),{putData:A,loading:p,error:l,response:m}=Ae(),b=v(!1),j=v(null),T=v("");function J(u){j.value=u.id,T.value=u.name,b.value=!0}const U=v(null);async function Q(u,s){U.value=u,await E(`${h.GET_COUNTRIES}/${u}`)?(g({message:`Pays "${s} supprimé avec success"`,type:"success"}),$.emit("countryUpdated")):g({message:S.value||"Suppression impossible",type:"error"}),U.value=null}async function ee(){if(!j.value)return;const u={name:T.value.trim()};if(await A(`${h.GET_COUNTRIES}/${j.value}`,u),l.value){g({message:l.value,type:"error"});return}m.value&&(g({message:"Pays mis à jour avec succès",type:"success"}),b.value=!1,$.emit("countryUpdated"))}ne(()=>{w(),$.on("countryUpdated",M)}),le(()=>{$.off("countryUpdated",M)});function M(){w()}const I=D(()=>{const u=V.value||[],s=x.value.trim().toLowerCase();return s?u.filter(i=>i.name.toLowerCase().includes(s)):u});return(u,s)=>(o(),F(_e,{breadcrumb:c,"active-route":"/admin","module-name":"admin"},{default:t(()=>[n("div",Pe,[a(ye,{title:"Administration",tags:_,"active-tag-name":k.value},null,8,["active-tag-name"]),a(ve,null,{default:t(()=>[n("div",Re,[n("div",Me,[a(e(P),{modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=i=>x.value=i),placeholder:"Rechercher un pays...",class:"w-full max-w-sm ps-10 h-10"},null,8,["modelValue"]),s[4]||(s[4]=n("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-foreground-muted/70"},[n("span",{class:"iconify hugeicons--search-01 text-sm"})],-1))]),n("div",Ie,[a(ze)])]),n("div",De,[e(N)?(o(),r("div",Oe,"Chargement...")):e(C)?(o(),r("div",Be,z(e(C)),1)):(o(),r(O,{key:2},[(I.value||[]).length===0?(o(),r("div",Fe," Aucun pays trouvé. ")):(o(),r("ul",Ge,[(o(!0),r(O,null,ie(I.value,i=>(o(),r("li",{key:i.id,class:"px-4 py-3 flex items-center justify-between"},[n("div",qe,[s[5]||(s[5]=n("span",{class:"iconify hugeicons--flag-02 text-primary"},null,-1)),n("span",Le,z(i.name),1)]),a(Te,null,{actions:t(()=>[a(e(f),{size:"sm",variant:"outline",class:"h-8",onClick:se=>J(i)},{default:t(()=>[...s[6]||(s[6]=[n("span",{class:"iconify hugeicons--edit-01"},null,-1),n("span",{class:"sr-only"},"Modifier",-1)])]),_:1},8,["onClick"]),a(e(oe),null,{default:t(()=>[a(e(re),{"as-child":""},{default:t(()=>[a(e(f),{size:"sm",variant:"destructive",class:"h-8"},{default:t(()=>[...s[7]||(s[7]=[n("span",{class:"iconify hugeicons--delete-02"},null,-1),n("span",{class:"sr-only"},"Supprimer",-1)])]),_:1})]),_:1}),a(e(ue),null,{default:t(()=>[a(e(de),null,{default:t(()=>[a(e(me),null,{default:t(()=>[...s[8]||(s[8]=[d("Supprimer ce pays ?",-1)])]),_:1}),a(e(pe),null,{default:t(()=>[...s[9]||(s[9]=[d(" Cette action est irréversible. Si des provinces dépendent de ce pays, la suppression sera refusée. ",-1)])]),_:1})]),_:1}),a(e(fe),null,{default:t(()=>[a(e(ce),null,{default:t(()=>[...s[10]||(s[10]=[d("Annuler",-1)])]),_:1}),a(e(f),{variant:"destructive",disabled:e(y)&&U.value===i.id,onClick:se=>Q(i.id,i.name)},{default:t(()=>[e(y)&&U.value===i.id?(o(),r("span",Ye,[a(R,{size:"sm"}),s[11]||(s[11]=n("span",null,"Suppression...",-1))])):(o(),r("span",Ke,"Confirmer"))]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)),a(e(G),{open:b.value,"onUpdate:open":s[3]||(s[3]=i=>b.value=i)},{default:t(()=>[a(e(q),{class:"sm:max-w-[420px]"},{default:t(()=>[a(e(L),null,{default:t(()=>[a(e(Y),null,{default:t(()=>[...s[12]||(s[12]=[d("Modifier un Pays",-1)])]),_:1}),a(e(K),null,{default:t(()=>[...s[13]||(s[13]=[d("Mettre à jour le nom du pays",-1)])]),_:1})]),_:1}),n("form",{onSubmit:W(ee,["prevent"])},[n("div",We,[n("div",Xe,[a(e(X),{for:"name",class:"text-sm font-medium"},{default:t(()=>[...s[14]||(s[14]=[d("Nom",-1)])]),_:1}),a(e(P),{id:"name",modelValue:T.value,"onUpdate:modelValue":s[1]||(s[1]=i=>T.value=i),class:"h-10",disabled:e(p),required:""},null,8,["modelValue","disabled"])])]),a(e(Z),{class:"flex justify-end gap-2 items-center"},{default:t(()=>[a(e(f),{size:"sm",class:"h-9",variant:"outline",type:"button",disabled:e(p),onClick:s[2]||(s[2]=i=>b.value=!1)},{default:t(()=>[...s[15]||(s[15]=[d("Annuler",-1)])]),_:1},8,["disabled"]),a(e(f),{size:"sm",class:"h-9",type:"submit",disabled:e(p)},{default:t(()=>[e(p)?(o(),r("span",He,[a(R,{size:"lg"}),s[17]||(s[17]=n("span",null,"Mise à jour...",-1))])):(o(),r("span",Ze,[...s[16]||(s[16]=[n("span",{class:"iconify hugeicons--floppy-disk"},null,-1),n("span",null,"Enregistrer",-1)])]))]),_:1},8,["disabled"])]),_:1})],32)]),_:1})]),_:1},8,["open"])]))],64))])]),_:1})])]),_:1}))}});export{cs as default};
