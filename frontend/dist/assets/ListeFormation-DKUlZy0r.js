import{d as P,r as E,A as x,v as I,p as $,x as c,w as a,f as s,b as i,i as e,k as w,$ as V,y as n,c as y,F as z,G as B,a as U,o as u,t as f,s as b}from"./index-CJ_PivE-.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{_ as M,a as j,b as p,c as d,d as q,e as r}from"./TableHeader.vue_vue_type_script_setup_true_lang-cS4zBTGx.js";import{_ as F}from"./Checkbox.vue_vue_type_script_setup_true_lang-DTckireD.js";import{_ as H}from"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import{_ as J}from"./SaisieRhLayout.vue_vue_type_script_setup_true_lang-CNwSXs2g.js";import{_ as K}from"./TabPagination.vue_vue_type_script_setup_true_lang-Dsg8W898.js";import{u as N}from"./useGetApi-EdzHoZm6.js";import{u as Q}from"./useDeleteApi-D2AjqV8w.js";import"./index-BpkKmY4O.js";import"./RovingFocusGroup-BxePylpC.js";import"./DashPageHeader.vue_vue_type_script_setup_true_lang-DucYyTAx.js";import"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";const W={class:"flex sm:items-center gap-3 flex-col sm:flex-row sm:justify-between"},X={class:"relative flex-1"},Y={class:"flex flex-wrap items-center sm:justify-end gap-2.5 flex-1"},Z={class:"mt-4 rounded-md overflow-hidden flex flex-1 bg-white"},ee={class:"flex items-center gap-2 w-max"},te={key:0,class:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white"},ae={key:1,class:"iconify hugeicons--delete-02"},xe=P({__name:"ListeFormation",setup(se){U();const D=E(1),h=E(15),{data:_,fetchData:k,loading:T}=N(x.GET_FORMATIONS_CONTINUES),{fetchData:A}=N(x.GET_PERSONALS);I(async()=>{await Promise.all([k(),A()])});const g=$(()=>{var t;return(Array.isArray(_.value)?_.value:((t=_.value)==null?void 0:t.data)||[]).map(l=>({id:l.id,nomFormation:l.title||"-",lieu_endroit:l.location||"-",dateStart:l.start_date?new Date(l.start_date).toLocaleDateString("fr-FR"):"N/A",dateEnd:l.end_date?new Date(l.end_date).toLocaleDateString("fr-FR"):"-",delay:l.start_date&&l.end_date?Math.ceil((new Date(l.end_date).getTime()-new Date(l.start_date).getTime())/(1e3*60*60*24))+" jours":"-",description:l.description||"-"}))}),C=$(()=>g.value.length),{deleteItem:L,deleting:v}=Q();function R(m){b({message:"La fonction d'édition sera disponible prochainement.",type:"info"})}async function S(m){if(window.confirm("Êtes-vous sûr de vouloir supprimer cette formation ?"))try{await L(x.DELETE_FORMATION_CONTINUE(m)),b({message:"Formation supprimée avec succès !",type:"success"}),await k()}catch(l){console.error("Erreur lors de la suppression:",l),b({message:"Erreur lors de la suppression de la formation.",type:"error"})}}return(m,t)=>{const l=V("RouterLink");return u(),c(J,{activeBread:"Formations Personnel","active-tag-name":"formation",group:"saisie"},{default:a(()=>[s(H,null,{default:a(()=>[i("div",W,[i("div",X,[s(e(G),{type:"text",id:"search",name:"search",placeholder:"Rechercher une formation...",class:"w-full max-w-sm ps-10 border border-gray-200/40 bg-white transition-all h-10 rounded-md"}),t[2]||(t[2]=i("div",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-foreground-muted/70"},[i("span",{class:"flex iconify hugeicons--search-01 text-sm"})],-1))]),i("div",Y,[s(e(w),{size:"md",class:"","as-child":""},{default:a(()=>[s(l,{to:"/rh/saisie/formation-continue/nouvelle-formation",class:"rounded-md max-sm:flex-1 sm:w-max flex items-center gap-2"},{default:a(()=>[...t[3]||(t[3]=[i("span",{class:"flex iconify hugeicons--plus-sign"},null,-1),i("span",{class:"hidden sm:flex"},"Nouvelle formation",-1)])]),_:1})]),_:1})])]),i("div",Z,[s(e(M),{class:"rounded-md bg-white"},{default:a(()=>[s(e(j),null,{default:a(()=>[s(e(p),null,{default:a(()=>[s(e(d),{class:"w-[20px]"},{default:a(()=>[s(e(F),{class:"bg-white scale-70"})]),_:1}),s(e(d),null,{default:a(()=>[...t[4]||(t[4]=[n("Nom formation",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[5]||(t[5]=[n("Lieu/Endroit",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[6]||(t[6]=[n("Date début",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[7]||(t[7]=[n("Date fin",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[8]||(t[8]=[n("Durée",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[9]||(t[9]=[n("Description",-1)])]),_:1}),s(e(d),null,{default:a(()=>[...t[10]||(t[10]=[n(" Opérations ",-1)])]),_:1})]),_:1})]),_:1}),s(e(q),null,{default:a(()=>[e(T)?(u(),c(e(p),{key:0},{default:a(()=>[s(e(r),{colspan:"8",class:"text-center py-8"},{default:a(()=>[...t[11]||(t[11]=[n(" Chargement... ",-1)])]),_:1})]),_:1})):g.value.length===0?(u(),c(e(p),{key:1},{default:a(()=>[s(e(r),{colspan:"8",class:"text-center py-8 text-gray-500"},{default:a(()=>[...t[12]||(t[12]=[n(" Aucune formation trouvée. ",-1)])]),_:1})]),_:1})):(u(!0),y(B,{key:2},z(g.value,o=>(u(),c(e(p),{key:o.id},{default:a(()=>[s(e(r),{class:"w-[40px]"},{default:a(()=>[s(e(F),{class:"bg-white scale-70"})]),_:1}),s(e(r),{class:"font-medium"},{default:a(()=>[n(f(o.nomFormation),1)]),_:2},1024),s(e(r),{class:"font-medium"},{default:a(()=>[n(f(o.lieu_endroit),1)]),_:2},1024),s(e(r),{class:"font-medium"},{default:a(()=>[n(f(o.dateStart),1)]),_:2},1024),s(e(r),{class:"font-medium"},{default:a(()=>[n(f(o.dateEnd),1)]),_:2},1024),s(e(r),{class:"font-medium"},{default:a(()=>[n(f(o.delay),1)]),_:2},1024),s(e(r),{class:"font-medium max-w-xs truncate",title:o.description},{default:a(()=>[n(f(o.description),1)]),_:2},1032,["title"]),s(e(r),null,{default:a(()=>[i("div",ee,[s(e(w),{variant:"outline",size:"icon",class:"size-8",onClick:O=>R(o.id),disabled:e(v)},{default:a(()=>[...t[13]||(t[13]=[i("span",{class:"iconify hugeicons--edit-02"},null,-1)])]),_:1},8,["onClick","disabled"]),s(e(w),{variant:"destructive",size:"icon",class:"size-8",onClick:O=>S(o.id),disabled:e(v)},{default:a(()=>[e(v)?(u(),y("span",te)):(u(),y("span",ae))]),_:1},8,["onClick","disabled"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),s(K,{modelValue:D.value,"onUpdate:modelValue":t[0]||(t[0]=o=>D.value=o),perPage:h.value,totalItems:C.value,"onUpdate:perPage":t[1]||(t[1]=o=>h.value=o)},null,8,["modelValue","perPage","totalItems"])]),_:1})]),_:1})}}});export{xe as default};
