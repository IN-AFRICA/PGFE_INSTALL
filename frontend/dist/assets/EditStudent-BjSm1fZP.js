import{d as Ge,a1 as Ke,r as $e,A as ze,s as P,a as Le,v as Je,x as We,w as a,c as o,b as c,f as t,h as d,i as e,z as _,y as u,j as m,t as p,B as Ie,C as qe,D as Ne,E as De,J as V,k as Te,g as Ye,m as He,o as n}from"./index-CJ_PivE-.js";import{_ as Ce}from"./FormSection.vue_vue_type_script_setup_true_lang-C-XSdIg3.js";import{I as v}from"./InputWrapper-tSRHzcjN.js";import{S as x}from"./SpanRequired-COKghTUX.js";import{_ as Qe}from"./DashFormLayout.vue_vue_type_script_setup_true_lang-3V-LyRCQ.js";import{_ as g}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{_ as Ae}from"./SelectGroup.vue_vue_type_script_setup_true_lang-CwIOzTi6.js";import{S as Xe}from"./Spinner-BZtQf9oC.js";import{u as Ze}from"./usePutApi-BrTvEW5v.js";import{e as el}from"./eventBus-CGRXT3Tn.js";import{_ as ll,a as tl,b as al,c as rl}from"./ListTerritory.vue_vue_type_script_setup_true_lang-9aLGTqa6.js";import{_ as sl}from"./ListParents.vue_vue_type_script_setup_true_lang-CN8jaBKj.js";import{u as nl,a as f,t as ol}from"./vee-validate-zod-Bra4yLtR.js";import{z as i}from"./external-CYeExkxg.js";import"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";import"./FormPageHeader.vue_vue_type_script_setup_true_lang-CAg7Z6LS.js";import"./index-BpkKmY4O.js";import"./useGetApi-EdzHoZm6.js";const ul={key:0,class:"w-full flex flex-col items-center justify-center py-20"},il={key:0,class:"text-xs text-red-500"},dl={key:0,class:"text-xs text-red-500"},ml={key:0,class:"text-xs text-red-500"},pl={key:0,class:"text-xs text-red-500"},vl={key:0,class:"text-xs text-red-500"},fl={key:0,class:"text-xs text-red-500"},_l={key:0,class:"text-xs text-red-500"},cl={key:0,class:"text-xs text-red-500"},gl={key:0,class:"text-xs text-red-500"},xl={key:0,class:"text-xs text-red-500"},Vl={key:0,class:"text-xs text-red-500"},bl={key:0,class:"text-xs text-red-500"},yl={key:0,class:"text-xs text-red-500"},Sl={key:0,class:"text-xs text-red-500"},El={key:0,class:"text-xs text-red-500"},kl={key:0,class:"text-xs text-red-500"},wl={key:0,class:"text-xs text-red-500"},Ml={class:"flex items-center justify-end gap-2"},Ul={key:0,class:"flex items-center gap-2"},hl={key:1},$l={class:"flex items-center gap-2"},Xl=Ge({__name:"EditStudent",setup(zl){const Be=i.object({name:i.string({required_error:"Veuillez saisir le nom"}).min(2).max(100),lastname:i.string({required_error:"Veuillez saisir le nom de famille"}).max(100).nullable(),firstname:i.string({required_error:"Veuillez saisir le prénom"}).min(2).max(100),gender:i.string({required_error:"Veuillez sélectionner le genre"}),birth_date:i.string({required_error:"Veuillez saisir la date de naissance"}),birth_place:i.string({required_error:"Veuillez saisir le lieu de naissance"}).min(2).max(100),civil_status:i.string({required_error:"Veuillez sélectionner l'état civil"}),address:i.string({required_error:"Veuillez saisir l'adresse"}).min(2).max(255),phone_number:i.string().min(2).max(30).nullable().optional(),email:i.string().email("Email invalide").nullable().optional(),country_id:i.coerce.number({required_error:"Veuillez sélectionner le pays"}),province_id:i.coerce.number({required_error:"Veuillez sélectionner la province"}),territory_id:i.coerce.number({required_error:"Veuillez sélectionner le territoire"}),commune_id:i.coerce.number({required_error:"Veuillez sélectionner la commune"}),parents_id:i.coerce.number({required_error:"Veuillez sélectionner le parent"}),previousSchool:i.string().max(255).optional(),percentageObtained:i.union([i.coerce.number().min(0).max(100),i.literal("")]).optional().default("")}),{handleSubmit:Oe,resetForm:Fe}=nl({validationSchema:ol(Be)}),{value:b,errorMessage:R}=f("name"),{value:y,errorMessage:j}=f("lastname"),{value:S,errorMessage:G}=f("firstname"),{value:E,errorMessage:K}=f("gender"),{value:h,errorMessage:L}=f("birth_date"),{value:$,errorMessage:J}=f("birth_place"),{value:z,errorMessage:W}=f("civil_status"),{value:I,errorMessage:Y}=f("address"),{value:q,errorMessage:H}=f("phone_number"),{value:N,errorMessage:Q}=f("email"),{value:k,errorMessage:X}=f("country_id"),{value:w,errorMessage:Z}=f("province_id"),{value:D,errorMessage:ee}=f("territory_id"),{value:T,errorMessage:le}=f("commune_id"),{value:M,errorMessage:te}=f("parents_id"),{value:C,errorMessage:ae}=f("previousSchool"),{value:A,errorMessage:re}=f("percentageObtained"),{loading:Pe,error:se,response:ne,putData:Re}=Ze(),{id:oe}=Ke().params,ue=Le(),s=$e(null),O=$e(!1),ie=Oe(async U=>{const l=ze.UPDATE_STUDENT.replace(":student",oe);if(await Re(l,U),el.emit("studentUpdated"),se.value){P({message:se.value,type:"error"});return}else ne.value&&(P({message:ne.value.message,type:"success"}),Fe(),ue.push("/apprenants/operations"))}),je=async()=>{var U,l,r,de,me,pe,ve,fe,_e,ce,ge,xe,Ve,be,ye,Se,Ee,ke,we,Me,Ue,he;O.value=!0;try{const{data:F}=await He.get(ze.GET_STUDENT_BY_ID.replace(":student",oe));s.value=F.student,console.log("[EditStudent] Student data loaded:",s.value),b.value=((U=s.value)==null?void 0:U.name)||"",y.value=((l=s.value)==null?void 0:l.lastname)||((r=s.value)==null?void 0:r.last_name)||"",S.value=((de=s.value)==null?void 0:de.firstname)||((me=s.value)==null?void 0:me.first_name)||"",E.value=((pe=s.value)==null?void 0:pe.gender)||"",z.value=((ve=s.value)==null?void 0:ve.civil_status)||"",I.value=((fe=s.value)==null?void 0:fe.address)||"",h.value=(_e=s.value)!=null&&_e.birth_date?new Date(s.value.birth_date).toISOString().slice(0,10):"",$.value=((ce=s.value)==null?void 0:ce.birth_place)||"",q.value=((ge=s.value)==null?void 0:ge.phone_number)||"",N.value=((xe=s.value)==null?void 0:xe.email)||"",k.value=(Ve=s.value)!=null&&Ve.country_id?String(s.value.country_id):"",w.value=(be=s.value)!=null&&be.province_id?String(s.value.province_id):"",D.value=(ye=s.value)!=null&&ye.territory_id?String(s.value.territory_id):"",T.value=(Se=s.value)!=null&&Se.commune_id?String(s.value.commune_id):"",M.value=(Ee=s.value)!=null&&Ee.father_id||(ke=s.value)!=null&&ke.parents_id?String(s.value.father_id||s.value.parents_id):"",C.value=((we=s.value)==null?void 0:we.previousSchool)??((Me=s.value)==null?void 0:Me.previous_school_name)??"";const B=((Ue=s.value)==null?void 0:Ue.percentageObtained)??((he=s.value)==null?void 0:he.previous_percentage);A.value=B==null||B===""?"":Number(B),console.log("[EditStudent] Form values set:",{name:b.value,lastname:y.value,firstname:S.value,gender:E.value,country_id:k.value,province_id:w.value,parents_id:M.value})}catch(F){console.error("[EditStudent] Error loading student:",F),P({message:"Erreur lors du chargement de l'étudiant",type:"error"})}finally{O.value=!1}};return Je(()=>{je()}),(U,l)=>(n(),We(Qe,{title:"Modifier un apprenant","link-back":"/apprenants/operations","group-route":"/apprenants/operations",module:"students",breadcrumb:[{label:"Élèves",href:"/apprenants"},{label:"Opérations",href:"/apprenants/operations"},{label:"Inscriptions",href:"/apprenants/operations"},{label:"Édition Élève",href:"#"}]},{default:a(()=>[O.value?(n(),o("div",ul,[...l[19]||(l[19]=[c("div",{class:"flex flex-col items-center space-y-4"},[c("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),c("p",{class:"text-gray-600 text-lg"},"Chargement des informations de l'étudiant...")],-1)])])):(n(),o("form",{key:1,class:"w-full flex flex-col space-y-8",onSubmit:l[18]||(l[18]=Ye((...r)=>e(ie)&&e(ie)(...r),["prevent"]))},[t(Ce,{class:"grid sm:grid-cols-2 lg:grid-cols-3 gap-y-6 gap-x-10",title:"Informations personnelles"},{default:a(()=>[t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[20]||(l[20]=u(" Nom ",-1)),t(x)]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"Kasongo",modelValue:e(b),"onUpdate:modelValue":l[0]||(l[0]=r=>m(b)?b.value=r:null)},null,8,["modelValue"]),e(R)?(n(),o("span",il,p(e(R)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[21]||(l[21]=u(" Nom de famille ",-1)),t(x)]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"Muleka",modelValue:e(y),"onUpdate:modelValue":l[1]||(l[1]=r=>m(y)?y.value=r:null)},null,8,["modelValue"]),e(j)?(n(),o("span",dl,p(e(j)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[22]||(l[22]=u(" Prénom ",-1)),t(x)]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"Isaac",modelValue:e(S),"onUpdate:modelValue":l[2]||(l[2]=r=>m(S)?S.value=r:null)},null,8,["modelValue"]),e(G)?(n(),o("span",ml,p(e(G)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[23]||(l[23]=u(" Genre ",-1)),t(x)]),_:1}),t(e(Ie),{modelValue:e(E),"onUpdate:modelValue":l[3]||(l[3]=r=>m(E)?E.value=r:null)},{default:a(()=>[t(e(qe),{id:"genre",class:"!h-10 bg-white w-full"},{default:a(()=>[t(e(Ne),{placeholder:"Sélectionner le genre"})]),_:1}),t(e(De),null,{default:a(()=>[t(e(Ae),null,{default:a(()=>[t(e(V),{value:"Masculin"},{default:a(()=>[...l[24]||(l[24]=[u("Masculin",-1)])]),_:1}),t(e(V),{value:"Féminin"},{default:a(()=>[...l[25]||(l[25]=[u("Féminin",-1)])]),_:1}),t(e(V),{value:"Non spécifié"},{default:a(()=>[...l[26]||(l[26]=[u("Non spécifié",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(K)?(n(),o("span",pl,p(e(K)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[27]||(l[27]=u(" Date de naissance ",-1)),t(x)]),_:1}),t(e(g),{type:"date",class:"bg-white transition-all h-10 rounded-md",modelValue:e(h),"onUpdate:modelValue":l[4]||(l[4]=r=>m(h)?h.value=r:null)},null,8,["modelValue"]),e(L)?(n(),o("span",vl,p(e(L)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[28]||(l[28]=u(" Lieu de naissance ",-1)),t(x)]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"Kinshasa",modelValue:e($),"onUpdate:modelValue":l[5]||(l[5]=r=>m($)?$.value=r:null)},null,8,["modelValue"]),e(J)?(n(),o("span",fl,p(e(J)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[29]||(l[29]=u(" État civil ",-1)),t(x)]),_:1}),t(e(Ie),{modelValue:e(z),"onUpdate:modelValue":l[6]||(l[6]=r=>m(z)?z.value=r:null)},{default:a(()=>[t(e(qe),{id:"etat-civil",class:"!h-10 bg-white w-full"},{default:a(()=>[t(e(Ne),{placeholder:"Sélectionner l'état civil"})]),_:1}),t(e(De),null,{default:a(()=>[t(e(Ae),null,{default:a(()=>[t(e(V),{value:"Célibataire"},{default:a(()=>[...l[30]||(l[30]=[u("Célibataire",-1)])]),_:1}),t(e(V),{value:"Marié(e)"},{default:a(()=>[...l[31]||(l[31]=[u("Marié(e)",-1)])]),_:1}),t(e(V),{value:"Divorcé(e)"},{default:a(()=>[...l[32]||(l[32]=[u("Divorcé(e)",-1)])]),_:1}),t(e(V),{value:"Veuf/Veuve"},{default:a(()=>[...l[33]||(l[33]=[u("Veuf(ve)",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(W)?(n(),o("span",_l,p(e(W)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[l[34]||(l[34]=u(" Adresse ",-1)),t(x)]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"123 Avenue de l'Université",modelValue:e(I),"onUpdate:modelValue":l[7]||(l[7]=r=>m(I)?I.value=r:null)},null,8,["modelValue"]),e(Y)?(n(),o("span",cl,p(e(Y)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[...l[35]||(l[35]=[u(" Téléphone ",-1)])]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"+243 123 456 789",modelValue:e(q),"onUpdate:modelValue":l[8]||(l[8]=r=>m(q)?q.value=r:null)},null,8,["modelValue"]),e(H)?(n(),o("span",gl,p(e(H)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[...l[36]||(l[36]=[u(" Adresse email ",-1)])]),_:1}),t(e(g),{type:"email",class:"bg-white transition-all h-10 rounded-md",placeholder:"exemple@email.com",modelValue:e(N),"onUpdate:modelValue":l[9]||(l[9]=r=>m(N)?N.value=r:null)},null,8,["modelValue"]),e(Q)?(n(),o("span",xl,p(e(Q)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(ll,{modelValue:e(k),"onUpdate:modelValue":l[10]||(l[10]=r=>m(k)?k.value=r:null)},null,8,["modelValue"]),e(X)?(n(),o("span",Vl,p(e(X)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(tl,{modelValue:e(w),"onUpdate:modelValue":l[11]||(l[11]=r=>m(w)?w.value=r:null)},null,8,["modelValue"]),e(Z)?(n(),o("span",bl,p(e(Z)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(al,{modelValue:e(D),"onUpdate:modelValue":l[12]||(l[12]=r=>m(D)?D.value=r:null)},null,8,["modelValue"]),e(ee)?(n(),o("span",yl,p(e(ee)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(rl,{modelValue:e(T),"onUpdate:modelValue":l[13]||(l[13]=r=>m(T)?T.value=r:null)},null,8,["modelValue"]),e(le)?(n(),o("span",Sl,p(e(le)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(sl,{modelValue:e(M),"onUpdate:modelValue":l[14]||(l[14]=r=>m(M)?M.value=r:null)},null,8,["modelValue"]),e(te)?(n(),o("span",El,p(e(te)),1)):d("",!0)]),_:1})]),_:1}),l[42]||(l[42]=c("div",{class:"w-full flex h-px bg-gray-300"},null,-1)),t(Ce,{class:"grid sm:grid-cols-2 lg:grid-cols-3 gap-y-6 gap-x-10",title:"Inscription"},{default:a(()=>[t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[...l[37]||(l[37]=[u("École de provenance",-1)])]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",placeholder:"Nom de l'école précédente",modelValue:e(C),"onUpdate:modelValue":l[15]||(l[15]=r=>m(C)?C.value=r:null)},null,8,["modelValue"]),e(ae)?(n(),o("span",kl,p(e(ae)),1)):d("",!0)]),_:1}),t(v,null,{default:a(()=>[t(e(_),{class:"text-sm"},{default:a(()=>[...l[38]||(l[38]=[u("Pourcentage obtenu",-1)])]),_:1}),t(e(g),{class:"bg-white transition-all h-10 rounded-md",type:"number",min:"0",max:"100",step:"0.01",placeholder:"Ex: 75%",modelValue:e(A),"onUpdate:modelValue":l[16]||(l[16]=r=>m(A)?A.value=r:null)},null,8,["modelValue"]),e(re)?(n(),o("span",wl,p(e(re)),1)):d("",!0)]),_:1})]),_:1}),c("div",Ml,[t(e(Te),{variant:"outline",type:"button",onClick:l[17]||(l[17]=r=>e(ue).push("/apprenants/operations"))},{default:a(()=>[...l[39]||(l[39]=[c("span",{class:"flex iconify hugeicons--cancel-01 mr-1.5"},null,-1),u(" Annuler ",-1)])]),_:1}),t(e(Te),{type:"submit"},{default:a(()=>[e(Pe)?(n(),o("span",hl,[c("div",$l,[t(Xe),l[41]||(l[41]=c("span",null,"Enregistrement en cours...",-1))])])):(n(),o("span",Ul,[...l[40]||(l[40]=[c("span",{class:"iconify hugeicons--floppy-disk mr-1"},null,-1),c("span",null,"Enregistrer",-1)])]))]),_:1})])],32))]),_:1}))}});export{Xl as default};
