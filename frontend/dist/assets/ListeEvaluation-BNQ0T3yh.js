import{d as Y,r as $,A as m,v as h,p as E,x as v,w as t,f as s,b as _,i as e,k as q,ab as O,y as o,c as U,F,G as M,o as c,t as d}from"./index-CJ_PivE-.js";import{_ as j}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{_ as z}from"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import{_ as H,a as J,b as x,c as u,d as K,e as r}from"./TableHeader.vue_vue_type_script_setup_true_lang-cS4zBTGx.js";import{_ as D}from"./Checkbox.vue_vue_type_script_setup_true_lang-DTckireD.js";import{_ as Q}from"./TabPagination.vue_vue_type_script_setup_true_lang-Dsg8W898.js";import{_ as W}from"./SaisieRhLayout.vue_vue_type_script_setup_true_lang-CNwSXs2g.js";import{u as g}from"./useGetApi-EdzHoZm6.js";import"./index-BpkKmY4O.js";import"./RovingFocusGroup-BxePylpC.js";import"./DashPageHeader.vue_vue_type_script_setup_true_lang-DucYyTAx.js";import"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";const X={class:"flex sm:items-center gap-3 flex-col sm:flex-row sm:justify-between"},Z={class:"relative flex-1"},aa={class:"flex flex-wrap items-center sm:justify-end gap-2.5 flex-1"},la={class:"mt-4 rounded-md overflow-hidden flex flex-1 bg-white"},va=Y({__name:"ListeEvaluation",setup(ea){const w=$(1),S=$(15),{data:A,fetchData:P,loading:k}=g(m.GET_EVALUATIONS),{data:b,fetchData:C}=g(m.GET_PERSONALS),{data:G,fetchData:N}=g(m.GET_SCHOOL_YEARS),{data:T,fetchData:I}=g(m.GET_SEMESTERS);h(async()=>{await Promise.all([P(),C(),N(),I()])});const R=f=>{var n;const l=(Array.isArray(b.value)?b.value:((n=b.value)==null?void 0:n.data)||[]).find(i=>i.id===f);return{name:l?`${l.name||l.nom||""} ${l.postnom||""} ${l.firstname||l.prenom||""}`.trim():"Inconnu",matricule:(l==null?void 0:l.matricule)||"N/A"}},L=f=>{const a=G.value,n=(Array.isArray(a)?a:(a==null?void 0:a.years)??(a==null?void 0:a.data)??[]).find(i=>i.id===f);return(n==null?void 0:n.name)||(n==null?void 0:n.year)||(n==null?void 0:n.libelle)||`${n==null?void 0:n.start_year}-${n==null?void 0:n.end_year}`||"N/A"},V=f=>{const a=T.value,n=(Array.isArray(a)?a:(a==null?void 0:a.data)??[]).find(i=>i.id===f);return(n==null?void 0:n.name)||(n==null?void 0:n.libelle)||(n==null?void 0:n.title)||`S${f}`},y=E(()=>{var a;return(Array.isArray(A.value)?A.value:((a=A.value)==null?void 0:a.data)||[]).map(l=>{const n=R(l.personnel_id||l.academic_personal_id),i=(l.c1_quantite_travail||0)+(l.c2_theorie_pratique||0)+(l.c3_determ_ress_perso||0)+(l.c4_ponctualite||0)+(l.c5_dr_att_posit_collab||0);let p="Insuffisant";return i>=80?p="Excellent":i>=60?p="Bien":i>=40&&(p="Passable"),{id:l.id,date:l.created_at?new Date(l.created_at).toLocaleDateString("fr-FR"):"N/A",matricule:n.matricule,personnel:n.name,schoolYear:L(l.school_year_id),semestre:V(l.semester_id),c1:l.c1_quantite_travail||0,c2:l.c2_theorie_pratique||0,c3:l.c3_determ_ress_perso||0,c4:l.c4_ponctualite||0,c5:l.c5_dr_att_posit_collab||0,total:i,rGlob:p,pointAmel:l.critiques||"-"}})}),B=E(()=>y.value.length);return(f,a)=>(c(),v(W,{activeBread:"Evaluation","active-tag-name":"evaluation",group:"saisie"},{default:t(()=>[s(z,null,{default:t(()=>[_("div",X,[_("div",Z,[s(e(j),{type:"text",id:"search",name:"search",placeholder:"Rechercher un personnel...",class:"w-full max-w-sm ps-10 border border-gray-200/40 bg-white transition-all h-10 rounded-md"}),a[2]||(a[2]=_("div",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-foreground-muted/70"},[_("span",{class:"flex iconify hugeicons--search-01 text-sm"})],-1))]),_("div",aa,[s(e(q),{size:"md",class:"rounded-md max-sm:flex-1 sm:w-max","as-child":""},{default:t(()=>[s(e(O),{to:"/rh/saisie/nouvelle-evaluation"},{default:t(()=>[...a[3]||(a[3]=[_("span",{class:"flex iconify hugeicons--plus-sign"},null,-1),_("span",{class:"hidden sm:flex"},"Nouvelle évaluation",-1)])]),_:1})]),_:1})])]),_("div",la,[s(e(H),{class:"rounded-md bg-white"},{default:t(()=>[s(e(J),null,{default:t(()=>[s(e(x),null,{default:t(()=>[s(e(u),{class:"w-[20px]"},{default:t(()=>[s(e(D),{class:"bg-white scale-70"})]),_:1}),s(e(u),null,{default:t(()=>[...a[4]||(a[4]=[o("Date",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[5]||(a[5]=[o("Matricule",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[6]||(a[6]=[o("Personnel",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[7]||(a[7]=[o("Ann. Scolaire",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[8]||(a[8]=[o("Semestre",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[9]||(a[9]=[o("C1",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[10]||(a[10]=[o("C2",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[11]||(a[11]=[o("C3",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[12]||(a[12]=[o("C4",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[13]||(a[13]=[o("C5",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[14]||(a[14]=[o("Total/100",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[15]||(a[15]=[o("Rend. Glob.",-1)])]),_:1}),s(e(u),null,{default:t(()=>[...a[16]||(a[16]=[o("Point à améliorer",-1)])]),_:1})]),_:1})]),_:1}),s(e(K),null,{default:t(()=>[e(k)?(c(),v(e(x),{key:0},{default:t(()=>[s(e(r),{colspan:"14",class:"text-center py-8"},{default:t(()=>[...a[17]||(a[17]=[o(" Chargement des évaluations... ",-1)])]),_:1})]),_:1})):y.value.length===0?(c(),v(e(x),{key:1},{default:t(()=>[s(e(r),{colspan:"14",class:"text-center py-8 text-gray-500"},{default:t(()=>[...a[18]||(a[18]=[o(" Aucune évaluation trouvée. ",-1)])]),_:1})]),_:1})):(c(!0),U(M,{key:2},F(y.value,l=>(c(),v(e(x),{key:l.id},{default:t(()=>[s(e(r),{class:"w-[40px]"},{default:t(()=>[s(e(D),{class:"bg-white scale-70"})]),_:1}),s(e(r),null,{default:t(()=>[o(d(l.date),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.matricule),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.personnel),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.schoolYear),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.semestre),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.c1),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.c2),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.c3),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.c4),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.c5),1)]),_:2},1024),s(e(r),{class:"font-semibold"},{default:t(()=>[o(d(l.total),1)]),_:2},1024),s(e(r),null,{default:t(()=>[o(d(l.rGlob),1)]),_:2},1024),s(e(r),{class:"max-w-xs truncate",title:l.pointAmel},{default:t(()=>[o(d(l.pointAmel),1)]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),_:1})]),s(Q,{modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=l=>w.value=l),perPage:S.value,totalItems:B.value,"onUpdate:perPage":a[1]||(a[1]=l=>S.value=l)},null,8,["modelValue","perPage","totalItems"])]),_:1})]),_:1}))}});export{va as default};
