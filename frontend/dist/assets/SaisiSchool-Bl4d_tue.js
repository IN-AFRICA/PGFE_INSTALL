import{_ as P}from"./DashLayout.vue_vue_type_script_setup_true_lang-Ch2egXHm.js";import{_ as z}from"./DashPageHeader.vue_vue_type_script_setup_true_lang-DucYyTAx.js";import{_ as j}from"./BoxPanelWrapper.vue_vue_type_script_setup_true_lang-CmJ-Iy6y.js";import{d as q,p as k,r as S,v as F,a2 as M,x as Y,w as o,b as t,f as a,i as s,k as d,c as i,t as w,G as C,F as H,a as W,A as f,o as n,R as X,S as Z,U as J,V as K,W as Q,y as p,X as ee,Y as se,Z as te,s as T}from"./index-CJ_PivE-.js";import{u as _}from"./useGetApi-EdzHoZm6.js";import{u as ae}from"./useDeleteApi-D2AjqV8w.js";import{e as v}from"./eventBus-CGRXT3Tn.js";import{_ as oe}from"./Input.vue_vue_type_script_setup_true_lang-B9adgRZV.js";import{_ as le}from"./IconifySpinner.vue_vue_type_script_setup_true_lang-C3Td1B5O.js";import{_ as ne}from"./TableRowActions.vue_vue_type_script_setup_true_lang-C8PT7-8D.js";import"./RightDashHeader.vue_vue_type_script_setup_true_lang-Bn3G870_.js";import"./index-BpkKmY4O.js";const ie={class:"pb-6 mx-auto w-full max-w-7xl"},re={class:"flex items-center gap-3 justify-between"},ue={class:"relative flex-1"},ce={class:"flex items-center gap-2"},de={class:"mt-4 flex-1 min-h-0 overflow-auto bg-white rounded-md border border-gray-100"},me={key:0,class:"p-4 text-sm text-gray-600"},fe={key:1,class:"p-4 text-sm text-red-600"},pe={key:0,class:"p-4 text-sm text-gray-600"},_e={key:1,class:"divide-y"},ve={class:"flex items-center gap-3"},he={class:"font-medium"},ge={key:0,class:"flex items-center gap-2"},ye={key:1},Ue=q({__name:"SaisiSchool",setup(xe){const h=W(),A={items:[{label:"Accueil",href:"/",icon:"hugeicons--home-01"},{label:"Administration",href:"/admin"},{label:"Écoles",isActive:!0}]},E=[{name:"ecoles",text:"Écoles",href:"/admin/ecoles"}],V=k(()=>"ecoles"),m=S(""),{data:D,loading:N,error:g,fetchData:y}=_(f.GET_SCHOOLS),{fetchData:U}=_(f.GET_PROVINCES),{fetchData:B}=_(f.GET_TYPES),{deleteItem:R,deleting:x,errorDelete:G}=ae();function I(r){h.push(`/admin/ecoles/edit/${r}`)}const u=S(null);async function L(r,e){u.value=r,await R(`/schools/${r}`)?(T({message:`École "${e}" supprimée avec succès`,type:"success"}),v.emit("schoolUpdated")):T({message:G.value||"Suppression impossible",type:"error"}),u.value=null}function O(){h.push("/admin/ecoles/nouveau")}const b=k(()=>{const r=D.value||[],e=m.value.trim().toLowerCase();return e?r.filter(l=>{var c;return(c=l.name)==null?void 0:c.toLowerCase().includes(e)}):r});F(()=>{y(),U(),B(),v.on("schoolUpdated",$)}),M(()=>{v.off("schoolUpdated",$)});function $(){y()}return(r,e)=>(n(),Y(P,{breadcrumb:A,"active-route":"/admin/ecoles","module-name":"admin"},{default:o(()=>[t("div",ie,[a(z,{title:"Administration",tags:E,"active-tag-name":V.value},null,8,["active-tag-name"]),a(j,null,{default:o(()=>[t("div",re,[t("div",ue,[a(s(oe),{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),placeholder:"Rechercher une école...",class:"w-full max-w-sm ps-10 h-10"},null,8,["modelValue"]),e[1]||(e[1]=t("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-foreground-muted/70"},[t("span",{class:"iconify hugeicons--search-01 text-sm"})],-1))]),t("div",ce,[a(s(d),{onClick:O},{default:o(()=>[...e[2]||(e[2]=[t("span",{class:"iconify hugeicons--add-01"},null,-1),t("span",null,"Nouvelle école",-1)])]),_:1})])]),t("div",de,[s(N)?(n(),i("div",me,"Chargement...")):s(g)?(n(),i("div",fe,w(s(g)),1)):(n(),i(C,{key:2},[(b.value||[]).length===0?(n(),i("div",pe," Aucune école trouvée. ")):(n(),i("ul",_e,[(n(!0),i(C,null,H(b.value,l=>(n(),i("li",{key:l.id,class:"px-4 py-3 flex items-center justify-between"},[t("div",ve,[e[3]||(e[3]=t("span",{class:"iconify hugeicons--school text-primary"},null,-1)),t("span",he,w(l.name),1)]),a(ne,null,{actions:o(()=>[a(s(d),{size:"sm",variant:"outline",class:"h-8",onClick:c=>I(l.id)},{default:o(()=>[...e[4]||(e[4]=[t("span",{class:"iconify hugeicons--edit-01"},null,-1),t("span",{class:"sr-only"},"Modifier",-1)])]),_:1},8,["onClick"]),a(s(X),null,{default:o(()=>[a(s(Z),{"as-child":""},{default:o(()=>[a(s(d),{size:"sm",variant:"destructive",class:"h-8"},{default:o(()=>[...e[5]||(e[5]=[t("span",{class:"iconify hugeicons--delete-02"},null,-1),t("span",{class:"sr-only"},"Supprimer",-1)])]),_:1})]),_:1}),a(s(J),null,{default:o(()=>[a(s(K),null,{default:o(()=>[a(s(Q),null,{default:o(()=>[...e[6]||(e[6]=[p("Supprimer cette école ?",-1)])]),_:1}),a(s(ee),null,{default:o(()=>[...e[7]||(e[7]=[p(" Cette action est irréversible. Si des données dépendent de cette école, la suppression sera refusée. ",-1)])]),_:1})]),_:1}),a(s(se),null,{default:o(()=>[a(s(te),null,{default:o(()=>[...e[8]||(e[8]=[p("Annuler",-1)])]),_:1}),a(s(d),{variant:"destructive",disabled:s(x)&&u.value===l.id,onClick:c=>L(l.id,l.name)},{default:o(()=>[s(x)&&u.value===l.id?(n(),i("span",ge,[a(le,{size:"sm"}),e[9]||(e[9]=t("span",null,"Suppression...",-1))])):(n(),i("span",ye,"Confirmer"))]),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]))],64))])]),_:1})])]),_:1}))}});export{Ue as default};
